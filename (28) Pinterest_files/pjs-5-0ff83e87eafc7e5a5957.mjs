(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([[5],{"7HzE":function(e,t,n){n.d(t,"a",function(){return d}),n.d(t,"b",function(){return f});var a=n("GyhR"),i=n.n(a),o=n("8WpO"),r=n("Qo1m"),s=n("Irlq"),l=n("+U6O");function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const d=1800,h=800,p=335,u=e=>({pointerEvents:"none",opacity:e?1:0,WebkitTransition:"opacity .3s ease-in-out",transition:"opacity .3s ease-in-out",zIndex:1}),m=e=>({opacity:e?1:0,WebkitTransition:"opacity .5s ease-in-out .75s",transition:"opacity .5s ease-in-out .75s",overflow:"visible"}),b=(e,t,n,a)=>{let i=null,o=null,r={},s={};const l=n.current.getBoundingClientRect();if(a&&a.current){const e=t.current.getBoundingClientRect();s=a.current.getBoundingClientRect(),r={left:l.left-e.left,top:l.top-e.top};const n={x:s.x-l.x,y:s.y-l.y},c={x:(s.width-l.width)/2,y:(s.height-l.height)/2};i=`translate(${n.x}px, ${n.y}px)`,o=`translate(${c.x}px, ${c.y}px)`}return{mask:{position:"absolute",left:r.left,top:r.top,width:e?s.width:l.width,height:e?s.height:l.height,WebkitTransformOrigin:"left top",transformOrigin:"left top",WebkitTransform:e?i:"none",transform:e?i:"none",WebkitTransition:"all .5s ease-in-out .25s",transition:"all .5s ease-in-out .25s",borderRadius:e?"8px 0px 0px 8px":"8px",zIndex:2},imageContainer:{width:l.width,height:l.height,WebkitTransformOrigin:"left top",transformOrigin:"left top",WebkitTransform:e?o:"none",transform:e?o:"none",WebkitTransition:"all .5s ease-in-out .25s",transition:"all .5s ease-in-out .25s"}}},g=e=>({opacity:e?1:0,WebkitTransform:e?"translateY(0)":"translateY(20%)",transform:e?"translateY(0)":"translateY(20%)",WebkitTransition:"all .5s ease-in-out .75s",transition:"all .5s ease-in-out .75s",textAlign:"center",marginTop:"24px"});class f extends a.PureComponent{constructor(...e){super(...e),c(this,"state",{isInitialized:!1}),c(this,"containerRef",Object(a.createRef)()),c(this,"pinDestinationRef",Object(a.createRef)())}componentDidMount(){this.requestAnimationFrameId=window.requestAnimationFrame(()=>{this.setState({isInitialized:!0})})}componentWillUnmount(){this.dismissTimeout&&clearTimeout(this.dismissTimeout)}componentDidUpdate(e,t){const n=this.state.isInitialized,a=this.props.onDismiss;n&&a&&!this.dismissTimeout&&(this.dismissTimeout=setTimeout(a,d+h))}render(){const e=this.props,t=e.firstRepin,n=e.pin,c=e.pinImageRef,d=e.selectedBoardName,h=n.description,f=void 0===h?"":h,v=n.images["236x"]||{},y=v.height,E=void 0===y?0:y,S=v.width,_=void 0===S?0:S,C=v.url,w=void 0===C?"":C,O=this.state.isInitialized,x=b(O,this.containerRef,c,this.pinDestinationRef),k=x.mask,T=x.imageContainer;return i.a.createElement(a.Fragment,null,i.a.createElement(l.b,{position:"absolute",top:!0,bottom:!0,right:!0,left:!0,ref:this.containerRef},i.a.createElement(l.b,{maxHeight:p,overflow:"hidden",dangerouslySetInlineStyle:{__style:k}},i.a.createElement(l.b,{dangerouslySetInlineStyle:{__style:T}},i.a.createElement(l.o,{alt:f,src:w||"",naturalHeight:E||1,naturalWidth:_||1}))),i.a.createElement(l.b,{color:"white",position:"absolute",top:!0,bottom:!0,right:!0,left:!0,dangerouslySetInlineStyle:{__style:u(O)}},i.a.createElement(l.b,{display:"flex",justifyContent:"center",alignItems:"center",direction:"column",height:"100%",dangerouslySetInlineStyle:{__style:m(O)}},i.a.createElement(o.a,{delay:1250,startAnimation:O},i.a.createElement(l.t,{shape:"rounded",width:270,height:180},i.a.createElement(l.b,{display:"flex",height:"100%",width:"100%"},i.a.createElement(l.b,{ref:this.pinDestinationRef,color:"transparent",marginRight:1,flex:"grow",height:"100%"}),i.a.createElement(l.b,{display:"flex",width:80,direction:"column"},i.a.createElement(l.b,{color:"lightGray",flex:"grow",marginBottom:1}),i.a.createElement(l.b,{color:"lightGray",flex:"grow"}))))),i.a.createElement(l.b,{paddingX:2,dangerouslySetInlineStyle:{__style:g(O)}},i.a.createElement(l.l,{size:"sm"},t?Object(s.b)(r.a._("You saved your first Pin to {{ selectedBoardName }}!","First board create confirmation message"),{selectedBoardName:d}):Object(s.b)(r.a._("You saved this Pin to {{ selectedBoardName }}!","Board create confirmation message"),{selectedBoardName:d})))))))}}c(f,"defaultProps",{firstRepin:!1})},AlW1:function(e,t,n){n.d(t,"a",function(){return S});var a=n("GyhR"),i=n.n(a),o=n("Ivf5"),r=n("D+W/"),s=n("Qo1m"),l=n("kIql"),c=n("evwu"),d=n("j/DJ"),h=n("Irlq"),p=n("7Iyi"),u=n("9Y9K"),m=n("J+kV");function b(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){f(e,t,n[t])})}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e){var t,n;return n=t=class extends a.Component{constructor(...e){super(...e),f(this,"state",{createBoardError:null,inputName:this.props.prefilledName||"",nameValidators:[Object(m.d)({message:s.a._("Don't forget to name your board!")}),Object(m.b)({max:r.a.MAX_CHARS_FOR_BOARD_TITLE,maxErrorString:Object(h.b)(s.a._("Please enter no more than {{ maxLength }} characters.","Validation error when a user input is too long"),{maxLength:r.a.MAX_CHARS_FOR_BOARD_TITLE})})],nameValidatorErrors:[],privacy:this.props.isAdAccountOwner?r.a.BoardPrivacy.PUBLIC:r.a.BoardPrivacy.PROTECTED,saving:!1}),f(this,"handleChangeName",(e,t)=>{const n=Object(m.f)(this.state.nameValidators,e);this.setState({inputName:e,nameValidatorErrors:n,createBoardError:null},()=>{t&&this.handleCreate()})}),f(this,"handleChangePrivacy",()=>{const e=this.state.privacy===r.a.BoardPrivacy.SECRET?r.a.BoardPrivacy.PUBLIC:r.a.BoardPrivacy.SECRET;this.setState({privacy:e})}),f(this,"handleCreate",()=>{const e=this.state,t=e.inputName,n=e.privacy,a=this.props,i=a.createBoard,o=a.invalidateResource,r=a.onCreate,l=a.isAdAccountOwner,c=a.advertiser_id,d=g({privacy:n,name:t},!l&&c?{advertiser_id:c}:{});this.setState({saving:!0,createBoardError:null}),i(d).then(e=>{this.setState({saving:!1}),r(e)}).catch(e=>{let t=s.a._("Uh oh! Something went wrong.");if(e.message){const n=e.message,a=e.message_detail;t=a?`${n} ${a}`:n}else"string"==typeof e&&(t=e);this.setState({saving:!1,createBoardError:t})}),o(n)})}UNSAFE_componentWillReceiveProps(e){e.prefilledName&&this.setState({inputName:e.prefilledName})}render(){const t=this.props,n=(t.createBoard,t.invalidateResource,b(t,["createBoard","invalidateResource"]));return i.a.createElement(e,Object.assign({onChangeBoardName:this.handleChangeName,onChangeBoardPrivacy:this.handleChangePrivacy,onBoardCreate:this.handleCreate},n,this.state))}},f(t,"displayName",`WithBoardCreatePane(${e.displayName||e.name})`),n}function y(e){const t=e.advertiser,n=e.viewer,a=!t||n.isAuth&&t.owner_user_id===n.id,i=t&&t.id;return g({isAdAccountOwner:a},i?{advertiser_id:i}:{})}function E(e,t){return{invalidateResource:n=>{e(Object(p.f)("BoardsResource",Object(d.a)(t.viewer.username,n===r.a.BoardPrivacy.SECRET)))},createBoard:t=>e(Object(c.e)(t))}}function S(e){return Object(u.compose)(l.a,Object(o.connect)(y,E),v)(e)}},FIpZ:function(e,t,n){var a=n("GyhR"),i=n.n(a),o=(n("rWj7"),n("Qo1m")),r=n("HcVA"),s=n("g4pz"),l=n("+U6O");t.a=(({link:e,grayscale:t=!1,handleClick:n,handleFocus:a})=>i.a.createElement("div",{className:"ShareLink"},i.a.createElement("div",{className:"link"},i.a.createElement("div",{className:"icon"},i.a.createElement(s.a,{size:30,grayscale:t})),i.a.createElement(r.a,{ref:e=>e&&e.focus(),className:"Input linkField",value:e,onFocus:a}),i.a.createElement("div",{className:"cancelLink",onClick:n},i.a.createElement(l.m,{accessibilityLabel:o.a._("Close","close copy link"),icon:"cancel",color:"gray"})))))},HcVA:function(e,t,n){n.d(t,"a",function(){return s});var a=n("GyhR"),i=n.n(a),o=n("hvnN"),r=n.n(o);class s extends a.Component{constructor(e,t){var n,a,i;super(e,t),i=(e=>{this.props.onChange&&this.props.onChange(e.target.value),this.setState({value:e.target.value,hasChanged:!0})}),(a="handleChange")in(n=this)?Object.defineProperty(n,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[a]=i,this.state={isFocused:this.props.focused||!1,value:this.props.value,hasChanged:void 0!==this.props.value}}componentDidMount(){this.state.isFocused&&this._input.focus()}UNSAFE_componentWillReceiveProps(e){this.setState({value:e.value})}getId(){return this.props.id}getValue(){return this.state.value}focus(){this._input.focus()}render(){return i.a.createElement("input",{autoComplete:this.props.autoComplete,className:this.props.className,disabled:this.props.disabled?"disabled":"",id:this.props.id,name:this.props.name,onBlur:this.props.onBlur?this.props.onBlur.bind(this):null,onChange:this.handleChange,onClick:this.props.onClick?this.props.onClick.bind(this):null,onFocus:this.props.onFocus?this.props.onFocus.bind(this):null,onKeyDown:this.props.onKeyDown?this.props.onKeyDown.bind(this):null,placeholder:this.props.placeholder,ref:e=>{this._input=e},style:this.props.style,type:this.props.type,value:this.state.value||""})}}s.propTypes={autoComplete:r.a.oneOf(["on","off"]),className:r.a.string,disabled:r.a.bool,focused:r.a.bool,id:r.a.string,name:r.a.string,onBlur:r.a.func,onChange:r.a.func,onClick:r.a.func,onFocus:r.a.func,onKeyDown:r.a.func,placeholder:r.a.string,style:r.a.object,type:r.a.oneOf(["url","text","password"]),value:r.a.string},s.defaultProps={type:"text"}},Kqiz:function(e,t,n){var a=n("GyhR"),i=n.n(a),o=n("7HzE"),r=n("Ivf5"),s=n("D+W/"),l=n("Qo1m"),c=n("Reqc"),d=n("AlW1"),h=n("9Y9K"),p=n("UmN8"),u=n("JXQe"),m=n("kIql"),b=n("+U6O");var g=Object(h.compose)(m.a,d.a)(class extends a.Component{constructor(...e){var t,n,a;super(...e),a=(e=>{e.preventDefault(),this.props.onBoardCreate()}),(n="handleBoardCreateFormSubmit")in(t=this)?Object.defineProperty(t,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[n]=a}render(){const e=this.props,t=e.createBoardError,n=e.inputName,a=e.nameValidatorErrors,o=e.onCancel,r=e.onChangeBoardName,d=e.onChangeBoardPrivacy,h=e.onInvite,m=e.privacy,g=e.saving,f=e.showTitle,v=e.isAdAccountOwner,y=e.viewer,E=0===a.length,S=m===s.a.BoardPrivacy.SECRET,_=y.isAuth&&0===y.boardCount;return i.a.createElement(b.b,{color:"white",height:"100%",position:"absolute",width:"100%",top:!0,left:!0},i.a.createElement("form",{onSubmit:this.handleBoardCreateFormSubmit,style:{height:"100%"}},i.a.createElement(b.b,{direction:"column",display:"flex",height:"100%"},f&&i.a.createElement(b.b,{display:"flex",marginTop:3,paddingX:6,paddingY:3},i.a.createElement(b.J,{size:"xl",bold:!0},l.a._("Create board"))),i.a.createElement(b.b,{padding:3},i.a.createElement(b.b,{marginBottom:2},i.a.createElement(b.p,{htmlFor:"boardEditName"},i.a.createElement(b.J,null,l.a._("Name")))),i.a.createElement(b.b,null,i.a.createElement(b.L,{errorMessage:a.join(", "),id:"boardEditName",name:"boardName",onChange:({value:e})=>r(e),placeholder:l.a._('Like "Places to Go" or "Recipes to Make"'),value:n}))),i.a.createElement(b.i,null),v&&i.a.createElement(i.a.Fragment,null,i.a.createElement(b.b,{padding:3},i.a.createElement(b.b,{marginBottom:2},i.a.createElement(b.p,{htmlFor:"secret"},i.a.createElement(b.J,null,l.a._("Secret","secret board")))),i.a.createElement(b.b,null,i.a.createElement(b.H,{onChange:d,id:"secret",switched:S}))),i.a.createElement(b.i,null),i.a.createElement(b.b,{display:"flex",flex:"grow",overflow:"hidden"},i.a.createElement(b.b,{width:"100%"},i.a.createElement(p.a,{name:"web_collaborators_in_board_create_v3",isEligible:_},({anyEnabled:e})=>i.a.createElement(u.a,{onSelectedCollaboratorsChange:h,inCollabInBoardCreateExperiment:e})))),i.a.createElement(b.i,null)),!v&&i.a.createElement(i.a.Fragment,null,i.a.createElement(b.b,{padding:3},i.a.createElement(b.b,{marginBottom:2},i.a.createElement(b.p,{htmlFor:"protected"},i.a.createElement(b.J,null,l.a._("Protected board (not listed on user's profile)","protected board")))),i.a.createElement(b.b,null,i.a.createElement(b.H,{onChange:()=>void 0,id:"protected",switched:!0,disabled:!0}))),i.a.createElement(b.i,null)),i.a.createElement(b.b,{padding:6},!!t&&i.a.createElement(b.b,{marginBottom:3},i.a.createElement(b.J,{align:"center",bold:!0,color:"red",size:"sm"},t)),i.a.createElement(b.b,{display:"flex",justifyContent:"between"},i.a.createElement(b.c,{inline:!0,onClick:o,text:l.a._("Cancel","cancel board create")}),i.a.createElement(c.b,{disabled:!n.trim()||!E||!!t||g,submitting:g,text:l.a._("Create","create a new board")}))))))}}),f=n("vBjq"),v=n("Y2BC"),y=n("OUI7"),E=n("cSL5");var S=Object(v.b)({name:"BoardSectionsRepinResource",key:"sectionsResource",options:e=>({board_id:e.board.id})})(class extends a.Component{constructor(...e){var t,n,a;super(...e),a=(e=>{const t=this.props,n=t.board,a=t.sectionsResource.data;return e.length>=E.a?[{items:Object(y.a)([n],e),customProps:{inSectionSelection:!0}},{items:Object(y.a)(a,e,"title")}]:[{items:[n],customProps:{inSectionSelection:!0}},{items:a}]}),(n="getSections")in(t=this)?Object.defineProperty(t,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[n]=a}render(){const e=this.props,t=e.sectionsResource,n=t.error,a=t.isLoaded,o=e.boardSavedTo,r=e.isSelectMode,s=e.onSectionCreate,c=e.onSectionSelected,d=e.pinId;return i.a.createElement(E.b,{isSelectMode:r,boardSavedTo:o,createButtonLabel:l.a._("Add section","Button for creating a board section"),hasLoadError:!!n,isLoaded:a,getSections:this.getSections,onCreate:s,onSelected:c,pinId:d})}}),_=n("7Iyi"),C=n("NmcB");function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const O=2,x=3,k=void 0,T=e=>{const t=[],n=[];return e.forEach(e=>{e.name.match(/^\d/)?n.push(e):t.push(e)}),[...t,...n]};function I(e,t,n){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){w(e,t,n[t])})}return e}({},e?{pin_id:e}:{},t?{username:t}:{},n?{advertiser_id:n,filter:"protected"}:{},{field_set_key:"board_picker",limit:k,shortlist_suggestions:O})}var j=Object(h.compose)(Object(r.connect)(function(e){const t=e.advertiser,n=e.viewer;return n.isAuth&&t&&t.owner_user_id!==n.id?{advertiser_id:t.id,username:t.owner_user_id}:{}}),Object(v.b)({name:"BoardPickerBoardsResource",key:"boardResource",options:e=>I(e.pinId,e.username,e.advertiser_id)}))(class extends a.Component{constructor(...e){super(...e),w(this,"getSections",e=>{const t=this.props.boardResource.data;if(!t)return[];const n=t.all_boards,a=t.boards_shortlist,i=T(n);return i.length<=x?[{items:i}]:e.length>=E.a?[{items:Object(y.a)(i,e)}]:[a.length?{items:a,title:l.a._("Top choices")}:{items:[]},{items:i,title:l.a._("All boards","title for board picker all boards section")}]})}render(){const e=this.props,t=e.boardResource,n=t.data,a=t.error,o=t.isLoaded,r=e.boardSavedTo,s=e.isSelectMode,l=e.onBoardCreate,c=e.onBoardSelected,d=e.pinId,h=o&&!!n&&n.all_boards.length<=x;return i.a.createElement(E.b,{isSelectMode:s,boardSavedTo:r,hasLoadError:!!a,hasLowBoardCount:h,isLoaded:o,getSections:this.getSections,onCreate:l,onSelected:c,pinId:d})}});function B(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var P=Object(r.connect)(null,function(e,t){return{invalidateResource:()=>{e(Object(_.f)("BoardPickerBoardsResource",I(t.pinId)))},invalidatePinBetterSaveResource:()=>{e(Object(_.f)("BoardPickerBoardsResource",{field_set_key:"board_picker"}))}}})(class extends i.a.Component{constructor(...e){super(...e),B(this,"state",{newName:"",selectedSectionBoard:this.props.boardWithSection||null,showCreate:this.props.showCreate||!1,inviteQueue:{}}),B(this,"close",()=>{const e=this.state,t=e.selectedSectionBoard,n=e.showCreate,a=this.props.onClose;n?this.setState({showCreate:!1},this.manageModalTitle):t?this.setState({selectedSectionBoard:null},this.manageModalTitle):a()}),B(this,"sendInvites",e=>{const t=this.state.inviteQueue;Object.keys(t).forEach(n=>{t[n].resource(e.id,[n])})}),B(this,"handleInvite",e=>{const t=this.state.inviteQueue;if(t[e.id]){const n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){B(e,t,n[t])})}return e}({},t);delete n[e.id],this.setState({inviteQueue:n})}else{const n=Object.assign({},t,{[e.id]:e});this.setState({inviteQueue:n})}}),B(this,"handleBoardCreate",e=>{const t=this.props.onBoardCreated;this.handleBoardSave(e,!0),t&&t(e)}),B(this,"handleBoardSave",(e,t)=>{const n=this.state.selectedSectionBoard,a=this.props,i=a.onBoardSave,o=a.invalidatePinBetterSaveResource;if((0,a.invalidateResource)(),o(),n&&"board_section"===e.type)return i(n,e,t);const r=e,s=r.section_count;!n&&(void 0===s?0:s)>0?this.setState({selectedSectionBoard:r},this.manageModalTitle):(this.sendInvites(e),i(r,void 0,t))}),B(this,"handleCreate",e=>t=>{t=t||"",this.setState({newName:t,showCreate:!0},this.manageModalTitle);const n=e?13105:13025,a=e?10306:249;Object(C.a)(101,{component:n,element:a})}),B(this,"manageModalTitle",()=>{const e=this.props.setModalTitle,t=this.state,n=t.selectedSectionBoard,a=t.showCreate;e&&e(a&&n?l.a._("Add section","Repin title for making a board section"):a&&!n?l.a._("Create board","Repin title for making a new board"):n&&!a?l.a._("Choose section","Repin title for choosing a board section"):l.a._("Choose board","Repin title for choosing a board"))})}render(){const e=this.props,t=e.boardSavedTo,n=e.isRepin,a=e.isSelectMode,o=e.pinId,r=e.setModalTitle,s=e.suggestedBoardTitle,l=this.state,c=l.newName,d=l.selectedSectionBoard,h=l.showCreate,p=!!d,u=!r;return i.a.createElement(b.b,{display:"flex",width:"100%",position:"relative"},i.a.createElement(b.b,{width:"100%",display:"flex",direction:"column",marginTop:4},d?i.a.createElement(S,{isSelectMode:a,board:d,boardSavedTo:t,onSectionCreate:this.handleCreate(p),onSectionSelected:this.handleBoardSave}):i.a.createElement(j,{isSelectMode:a,boardSavedTo:t,onBoardCreate:this.handleCreate(p),onBoardSelected:this.handleBoardSave,pinId:o})),h&&!d&&i.a.createElement(g,{prefilledName:c||s,onCancel:this.close,onCreate:this.handleBoardCreate,onInvite:this.handleInvite,showTitle:u}),h&&d&&i.a.createElement(f.a,{board:d,completeCreateSectionAction:this.handleBoardSave,initialName:c,isRepin:n,onClearModal:this.close,showTitle:u}))}}),R=n("iz36"),D=n("dsfX"),A=n("RiVL"),L=n("n/kK"),N=n("TYRv"),F=n("aqOH"),M=n("SMmS");function H(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var W=Object(h.compose)(Object(r.connect)(({viewer:e})=>({userId:e.isAuth?e.id:""})),Object(M.b)({name:"UserResource",key:"userSocial",options:e=>({user_id:e.userId,field_set_key:"social_connect"})}))(class extends a.Component{constructor(...e){super(...e),H(this,"state",{isFacebookChecked:this.props.resourceLoaded&&!!this.props.userSocial&&this.props.userSocial.facebook_publish_stream_enabled,isTwitterChecked:this.props.resourceLoaded&&!!this.props.userSocial&&this.props.userSocial.twitter_publish_enabled}),H(this,"handleTwitterCheckboxChanged",()=>{const e=!this.state.isTwitterChecked;this.setState({isTwitterChecked:e}),this.props.onSocialConnect(N.a.TWITTER,e)}),H(this,"handleFacebookCheckboxChanged",()=>{const e=!this.state.isFacebookChecked;e?L.a.maybeRequestFbTimelinePermission({success:()=>{this.setState({isFacebookChecked:!0}),F.default.set("facebook_publish_stream_enabled",e),this.props.onSocialConnect(N.a.FACEBOOK,e)},error:()=>{this.setState({isFacebookChecked:!1}),F.default.set("facebook_publish_stream_enabled",!1),this.props.onSocialConnect(N.a.FACEBOOK,e)}}):(this.setState({isFacebookChecked:!1}),F.default.set("facebook_publish_stream_enabled",!1),this.props.onSocialConnect(N.a.FACEBOOK,e))}),H(this,"renderFacebookShare",()=>a.createElement(b.b,{display:"flex",alignItems:"center",marginLeft:2},a.createElement(b.e,{checked:this.state.isFacebookChecked,id:"share_facebook",onChange:this.handleFacebookCheckboxChanged,size:"sm"}),a.createElement(b.p,{htmlFor:"share_facebook"},a.createElement(b.b,{marginLeft:2},a.createElement(b.J,null,l.a._("Post to Facebook")))))),H(this,"renderTwitterShare",()=>a.createElement(b.b,{display:"flex",alignItems:"center",marginLeft:5},a.createElement(b.e,{checked:this.state.isTwitterChecked,id:"share_twitter",onChange:this.handleTwitterCheckboxChanged,size:"sm"}),a.createElement(b.p,{htmlFor:"share_twitter"},a.createElement(b.b,{marginLeft:2},a.createElement(b.J,null,l.a._("Post to Twitter"))))))}UNSAFE_componentWillReceiveProps({resourceLoaded:e,userSocial:t}){e&&t&&this.setState({isFacebookChecked:!!t.facebook_publish_stream_enabled,isTwitterChecked:!!t.twitter_publish_enabled})}render(){const e=this.props,t=e.resourceLoaded,n=e.userSocial;if(!t||!n)return null;const i=n.connected_to_facebook,o=n.twitter_url;return!(!i&&!o)&&a.createElement(b.b,{display:"flex",padding:2},i&&this.renderFacebookShare(),o&&this.renderTwitterShare())}}),U=n("Qcp0"),z=(n("rHfS"),n("bWet")),K=n("ms9C"),J=n("FIpZ");function V(e){let t,n,i="-7 -7 30 30";switch(e.name){case"facebook":n=a.createElement("circle",{cx:"8",cy:"8",r:"15",fill:"#3B5998"}),t=a.createElement("path",{fill:"#fff",d:"M9.267 16V8.702h2.506l.376-2.845H9.267V4.041c0-.823.234-1.384 1.442-1.384l1.541-.001V.112A21.09 21.09 0 0 0 10.005 0C7.783 0 6.262 1.325 6.262 3.76v2.097H3.75v2.845h2.512V16h3.005z"});break;case"messenger":n=a.createElement("circle",{cx:"8",cy:"8",r:"15",fill:"#1DA1F2"}),t=a.createElement("path",{fill:"#fff",d:"M8 0C3.582 0 0 3.316 0 7.407c0 2.332 1.163 4.41 2.981 5.769V16l2.724-1.495c.727.201 1.497.31 2.295.31 4.418 0 8-3.317 8-7.408C16 3.317 12.418 0 8 0zm.795 9.975L6.758 7.802 2.783 9.975l4.372-4.642 2.087 2.173 3.926-2.173-4.373 4.642z"});break;case"pinterest":i="0 0 16 16",t=a.createElement("path",{fill:"#e60023",d:"M5.644 15.648A8.01 8.01 0 0 0 8 16a8 8 0 1 0-2.847-.521c-.073-.625-.151-1.655.017-2.378.145-.621.934-3.958.934 -3.958s-.238-.477-.238-1.183c0-1.107.642-1.934 1.44-1.934.68 0 1.008.51 1.008 1.122 0 .683-.435 1.705-.66 2.652-.187.792.398 1.439 1.18 1.439 1.416 0 2.504-1.493 2.504-3.647 0-1.907-1.37-3.24-3.327 -3.24-2.266 0-3.596 1.7-3.596 3.456 0 .684.264 1.418.593 1.817a.238.238 0 0 1 .055.229c-.06.252-.195.792-.221.903-.035.146-.116.177-.267.107C3.581 10.4 2.96 8.946 2.96 7.778c0-2.512 1.825-4.82 5.262-4.82 2.763 0 4.91 1.97 4.91 4.6 0 2.745-1.73 4.954-4.133 4.954-.807 0-1.566-.42-1.825-.914 0 0-.4 1.52-.496 1.893-.188.722-.71 1.637-1.033 2.157z"});break;case"link":n=a.createElement("circle",{cx:"8",cy:"8",r:"15",fill:"#EFEFEF"}),t=a.createElement("path",{fill:"#8e8e8e",d:"M6.555 7.236L4.848 8.943l-2.389 2.39 2.21 2.21 2.39-2.39 1.707-1.707.82.821a.92.92 0 0 1 .006 1.301l-4.166 4.167a.926.926 0 0 1-1.302-.005L.272 11.878a.92.92 0 0 1-.005-1.302L4.433 6.41a.924.924 0 0 1 1.302.005l.82.821zM9.45 8.764l1.707-1.707 2.389-2.389-2.21-2.211-2.39 2.389-1.707 1.707-.82-.82a.921.921 0 0 1-.006-1.302L10.578.265a.924.924 0 1 1.301.006l3.853 3.852a.92.92 0 0 1 .004 1.301l-4.165 4.167a.924.924 0 0 1-1.302-.006l-.82-.82zm-4.573.889l4.779-4.78 1.473 1.474-4.779 4.78-1.473-1.474z"});break;default:t=null}return a.createElement("svg",{width:"36",height:"36",viewBox:i},n,t)}var Y=n("dMYx");function G(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Q extends a.Component{constructor(...e){super(...e),G(this,"state",{showShareLink:!1,pinterestProfileLink:"",fb:null}),G(this,"selectText",e=>{e.target.select()}),G(this,"openSocialDialog",(e,t)=>{const n=this.props,a=n.handleShare,i=n.dismissModal,o=n.experienceComplete;let r;switch(e){case"facebook":z.default.logIn(this.state.fb,()=>{K.a.shareFacebookInvite(this.getShareOptions(5))});break;case"messenger":z.default.logIn(this.state.fb,()=>{K.a.shareFbMessengerInvite(this.getShareOptions(6))});break;case"link":r=this.getShareOptions(12),K.a.createAndLogShareInvite(r).then(e=>{const t=e.invite_url;t?this.setState({pinterestProfileLink:t,showShareLink:!0}):a&&a()});break;default:a&&a()}"link"!==e&&(o&&o(),i(!0))}),G(this,"handleShareLinkDismiss",e=>{this.setState({showShareLink:!1})}),G(this,"handleFacebookClick",e=>{this.openSocialDialog("facebook",e)}),G(this,"handleMessengerClick",e=>{this.openSocialDialog("messenger",e)}),G(this,"handlePinterestClick",e=>{this.openSocialDialog("pinterest",e)}),G(this,"handleLinkClick",e=>{this.openSocialDialog("link",e)})}componentDidMount(){z.default.ensureInit(e=>this.setState({fb:e}))}getShareOptions(e){const t=this.props.pin;return{invite_channel:e,object_type:Y.a.PIN,object_id:t.id,name:"",description:t.description||"",path:`/pin/${t.id}/`,picture:t.images&&t.images["236x"]&&t.images["236x"].url||""}}render(){const e=this.props.close,t=this.state,n=t.pinterestProfileLink,a=t.showShareLink,o=i.a.createElement(J.a,{link:n,handleClick:this.handleShareLinkDismiss,handleFocus:this.selectText}),r=(e,t,n)=>{const r="share-upsell-label-"+e;let s="";return"facebook"===e?s="#3b5998":"messenger"===e&&(s="#1da1f2"),"link"===e&&a?o:i.a.createElement(b.O,{onTouch:({event:e})=>n(e),fullWidth:!1},i.a.createElement(b.b,{display:"flex",paddingY:2,alignItems:"center"},i.a.createElement(V,{name:e}),i.a.createElement(b.g,{xs:1}),i.a.createElement("div",{id:r},i.a.createElement(b.J,{size:"xl",bold:!0},i.a.createElement("span",{style:{color:s}},t)))))};return i.a.createElement(b.b,{display:"flex",alignItems:"center",dangerouslySetInlineStyle:{__style:{borderLeft:"1px solid #f5f5f5"}}},i.a.createElement("div",null,i.a.createElement(b.b,{paddingX:6,flex:"none"},i.a.createElement(b.b,{position:"absolute",dangerouslySetInlineStyle:{__style:{top:16,right:16}}},i.a.createElement(b.n,{icon:"cancel",onClick:e,accessibilityLabel:l.a._("Cancel"),size:"sm"})),i.a.createElement(b.l,{size:"md"},l.a._("Saved!","Save pin to board")),i.a.createElement(b.b,{paddingY:3,marginRight:8},i.a.createElement(b.J,{size:"xl"},l.a._("Know someone who might like it?","Upsell share a recently saved pin to board"))),i.a.createElement(b.b,{paddingY:2,flex:"none"},r("facebook",l.a._("Send on Facebook"),this.handleFacebookClick),r("messenger",l.a._("Send on Messenger"),this.handleMessengerClick),r("pinterest",l.a._("Send on Pinterest"),this.handlePinterestClick),r("link",l.a._("Send a link"),this.handleLinkClick)))),i.a.createElement(b.g,{xs:1}))}}function q(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"a",function(){return X}),n.d(t,"c",function(){return Z}),n.d(t,"b",function(){return ee});const X=4e3,$=660,Z={LOADING:"loading",SUCCESS:"success"};class ee extends a.Component{constructor(...e){super(...e),q(this,"state",{experienceComplete:()=>{},experienceDismiss:()=>{},height:0}),q(this,"pinImageRef",Object(a.createRef)()),q(this,"unmounted",!1),q(this,"safeSetState",(e,t)=>{this.unmounted?t&&t():this.setState(e,t)}),q(this,"scrollToRelatedPins",()=>{document&&document.documentElement&&"scrollBehavior"in document.documentElement.style?window.scroll({top:this.state.height,left:0,behavior:"smooth"}):window.scrollTo(0,this.state.height)}),q(this,"_adjustHeightToPin",()=>{0===this.state.height&&(this.safeSetState({height:$}),this.props.onHeightChange&&this.props.onHeightChange($))}),q(this,"close",()=>{const e=this.props.handleAbort;this.experienceDismiss&&this.experienceDismiss(),e()}),q(this,"dismissModal",e=>{const t=this.props.dismissModal;this.experienceDismiss&&!e&&this.experienceDismiss(),t&&t()})}componentDidMount(){this._adjustHeightToPin()}componentDidUpdate(){this._adjustHeightToPin()}componentWillUnmount(){this.unmounted=!0}render(){const e=this.props,t=e.boardSavedTo,n=e.boardWithSection,a=e.color,r=e.displaySuccessAnimation,s=e.handleNewBoardAnimationCompletion,c=e.handleSocialConnectSet,d=e.handleSaveToBoard,h=e.isInModal,p=e.newPin,u=e.pin,m=e.onCloseAndShare,g=e.onBoardCreated,f=e.sensitiveContentNotice,v=e.setModalTitle,y=e.showCreate,E=e.showSharingUpsell,S=e.shouldRenderContent,_=e.suggestedBoardTitle,C=e.updateDescription;if(!u||!u&&!u.resourceLoaded||!S)return null;const w=this.state.height;let O=null;p&&p.board&&(O=p.board.name);const x=w||660,k=f&&f.title||this.props.modalTitle,T=f?i.a.createElement(U.a,{notice:f,inModal:!0}):i.a.createElement(b.b,{position:"relative",height:x,width:"100%",display:"flex",justifyContent:"center"},i.a.createElement(b.b,{color:"white",display:"flex",height:"100%",overflow:"hidden",position:"relative",shape:"rounded",width:"100%"},i.a.createElement(b.b,{width:"40%",direction:"column",display:"flex",justifyContent:"between",dangerouslySetInlineStyle:{__style:{borderRight:"1px solid #f5f5f5"}}},i.a.createElement(b.b,{display:"flex",flex:"grow",alignItems:"center",justifyContent:"start",direction:"column",marginTop:3},i.a.createElement(A.a,{color:a,pin:u,pinImageRef:this.pinImageRef,updateDescription:C})),i.a.createElement(W,{onSocialConnect:c})),E?i.a.createElement(R.a,{placementId:33,experienceIds:[500388]},({complete:e,dismiss:t,display_data:n})=>(this.experienceComplete=e,this.experienceDismiss=t,i.a.createElement(Q,{handleShare:m,close:this.close,experienceComplete:e,pin:u,dismissModal:this.dismissModal}))):i.a.createElement(b.b,{display:"flex",width:"60%"},i.a.createElement(P,{boardSavedTo:t,boardWithSection:n,isRepin:!0,onBoardCreated:g,onBoardSave:d,onClose:this.close,pinId:u.id,showCreate:y,suggestedBoardTitle:_,setModalTitle:h?v:void 0}))),r&&i.a.createElement(o.b,{onDismiss:()=>{s(),this.dismissModal()},pin:u,pinImageRef:this.pinImageRef,selectedBoardName:O}));return h?i.a.createElement(D.b,{accessibilityCloseLabel:l.a._("Close"),accessibilityModalLabel:k,onDismiss:this.close,heading:k,size:"lg"},T):T}}q(ee,"defaultProps",{pwtAuxData:{}})},LxOv:function(e,t,n){var a=n("aqOH");const i=function(e){const t=document.documentElement;let n=t.scrollWidth-t.clientWidth,i=t.scrollHeight-t.clientHeight;e&&(n=Math.max(n,0),i=Math.max(i,0)),a.default.isAuthenticated()||(i=340),window.resizeBy(n,i)},o={};o.open=function(e,t,n){const a=function(e,t){const n=screen.width,a=screen.height;return"scrollbars=yes,resizable=yes,toolbar=no,location=yes,width="+e+",height="+t+",left="+Math.round((n-e)/2)+",top="+(a>t?Math.round((a-t)/2):0)}(t,n);window.open(e,void 0,a)},o.shrinkWrap=function(){i(!1)},o.contain=function(){i(!0)},o.resizeViewPort=function(e,t){window.outerWidth?window.resizeTo(e+(window.outerWidth-window.innerWidth),t+(window.outerHeight-window.innerHeight)):(window.resizeTo(500,500),window.resizeTo(e+(500-document.body.offsetWidth),t+(500-document.body.offsetHeight)))},t.a=o},MFVv:function(e,t,n){n.d(t,"b",function(){return i}),n.d(t,"a",function(){return o});var a=n("D+W/");const i=(e,t)=>{if(!t)return e;const n=new RegExp(/http(s?):/);if(!n.test(e)){const a=n.exec(t);if(a&&a.length){e=a[0]+e}}return e},o=e=>{const t=a.a.MAX_CHARS_FOR_BOARD_PIN_DESCRIPTION;return{clamped:e.length>50?e.slice(0,50).trim()+"…":e,full:e.length>t?e.slice(0,t):e}}},"QMJ+":function(e,t,n){n.d(t,"a",function(){return s});var a=n("GyhR"),i=n("D+W/"),o=n("q579"),r=n("+U6O");function s({url:e,description:t,color:n}){return n=n||i.a.DEFAULT_IMAGELESS_PIN_COLOR,a.createElement(r.b,{shape:"rounded",height:216,width:"100%",dangerouslySetInlineStyle:{__style:{background:n}}},a.createElement(r.b,{maxHeight:200,padding:4,overflow:"hidden"},e&&a.createElement(r.b,{marginBottom:2},a.createElement(r.J,{color:"white",size:"xs"},o.a.parse(e).hostname||e)),a.createElement(r.b,{maxHeight:144},a.createElement(r.J,{bold:!0,color:"white",overflow:"normal",size:"lg"},t))))}},Qcp0:function(e,t,n){var a=n("GyhR"),i=n.n(a),o=n("iJ35"),r=n("+U6O");function s({action:e,alignCenter:t}){const n=e.title,a=e.description,s=e.button,l=n&&n.text,c=a&&a.text,d=s&&s.text||"",h=s&&s.link||"",p=s&&s.link?s.link.replace(/^(?:https?:\/\/)?(?:www\.)?/i,"").replace("/",""):"";return s&&d&&h.startsWith("http")?i.a.createElement(r.b,null,i.a.createElement(r.b,{marginBottom:1},i.a.createElement(r.J,{bold:!0,align:t?"center":"left"},""!==d?d:"Visit")),i.a.createElement(r.b,{marginBottom:1},i.a.createElement(o.b,{className:"underlineLink",to:h},i.a.createElement("span",{style:{textDecoration:"underline"}},i.a.createElement(r.J,{align:t?"center":"left",truncate:!0},p))))):i.a.createElement(r.b,null,!!l&&i.a.createElement(r.b,{marginBottom:1},i.a.createElement(r.J,{bold:!0,align:t?"center":"left"},l)),!!c&&i.a.createElement(r.b,{marginBottom:1},i.a.createElement(r.J,{align:t?"center":"left"},c)))}n.d(t,"a",function(){return d});const l={backgroundColor:"#E1F8F7",boxShadow:"0 4px 16px rgba(0, 0, 0, 0.04)"},c={boxShadow:"0 4px 16px rgba(0, 0, 0, 0.04)"};function d({inModal:e,notice:t}){const n=t.title,a=t.description,o=t.actions,d=void 0===o?[]:o,h=a&&a.text||"",p=1===d.length;return i.a.createElement(r.b,{shape:"rounded",padding:6,dangerouslySetInlineStyle:{__style:e?c:l}},!!n&&!e&&i.a.createElement(r.b,{marginBottom:2,display:"flex"},i.a.createElement(r.l,{size:"xs"},n)),!!h&&i.a.createElement(r.b,{marginBottom:4},i.a.createElement("span",{style:{whiteSpace:"pre-wrap"}},i.a.createElement(r.J,{overflow:"normal",align:e?"center":"left"},h))),!!d.length&&i.a.createElement(r.b,{display:"flex",wrap:!0,marginStart:-2,marginEnd:-2,direction:e?"column":"row"},d.map(t=>i.a.createElement(r.b,{column:e||p?12:6,paddingY:1,paddingX:2,key:JSON.stringify(t)},i.a.createElement(s,{action:t,alignCenter:e||p})))))}},RTyF:function(e,t,n){var a=n("GyhR"),i=n.n(a),o=n("Ivf5"),r=n("POeB"),s=n("UgxU"),l=n("A6bX"),c=n("XwKk"),d=n("Qo1m");var h=n("4+0X"),p=n("ePT2"),u=n("TYRv"),m=n("KCDi"),b=n("SMmS"),g=n("KsVg"),f=n("lixz"),v=n("CAUj"),y=n("9Y9K"),E=n("VSY/"),S=n("dBWR"),_=n("MFVv"),C=n("mpDz"),w=n("NmcB"),O=n("3Wjl"),x=n("Kqiz"),k=n("evwu");function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){I(e,t,n[t])})}return e}function I(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"b",function(){return D}),n.d(t,"a",function(){return A});const j=/#[^(\-\\.\s#,\/$%\^&\*;:{}=\`~()\[\]@|<>…)]+/gi,B="236x";class P extends i.a.Component{constructor(...e){super(...e),I(this,"state",{boardSavedTo:null,displaySuccessAnimation:!1,experienceComplete:()=>{},experienceDismiss:()=>{},newPin:null,modalTitle:this.props.showCreate?d.a._("Create board"):d.a._("Choose board")||"",pinDescription:this.props.pin&&this.props.pin.description||"",resolve:void 0,sharing:{facebook:!1,twitter:!1},showSharingUpsell:!1}),I(this,"unmounted",!1),I(this,"setModalTitle",e=>this.safeSetState({modalTitle:e})),I(this,"updateDescription",e=>{this.safeSetState({pinDescription:e})}),I(this,"close",()=>{const e=this.props.onClose;e&&e(),this.setPWTAbort("boardPickerClose"),Object(w.a)(2502,{component:5,element:610})}),I(this,"safeSetState",(e,t)=>{this.unmounted?t&&t():this.setState(e,t)}),I(this,"getPinResource",(e,t,n)=>{const a=this.props,i=a.color,o=a.location,r=a.pin,s=a.method,l=a.guid,d=a.additionalCreateFields,h=a.advertiser_id;let u;r.id&&(u=Object(c.a)(r,o)||`${r.tracking_params}~0`);const m=r.id?"RepinResource":"PinResource",b=!r.id&&r.image_url?Object(_.b)(r.image_url,r.link):"",g=T({},d,{board_id:t||"",color:i||"",clientTrackingParams:u,description:this.state.pinDescription,guid:l||"",link:r.link,image_base64:r.image_base64,image_url:b,is_buyable_pin:!1,is_removable:r.promoted_is_removable,media_upload_id:r.media_upload_id,method:s||"",pin_id:r.id||"",section:n,title:r.title||""},h?{advertiser_id:h}:{});if(!e){const e=this.state.sharing,t=e.facebook,n=e.twitter;g.share_facebook=t,g.share_twitter=n}return p.a.create(m,g)}),I(this,"triggerPubSubs",e=>{h.a.instance.publish("currentUser","pinCreated",e),h.a.instance.publish(e.board.id,"pinCreated",{pin:e})}),I(this,"makeCancelablePromise",e=>{let t=!1;return{promise:new Promise((n,a)=>{e.then(e=>t?a({isCanceled:!0}):n(e)),e.catch(e=>a(t?{isCanceled:!0}:e))}),cancel(){t=!0}}}),I(this,"getSavedToText",(e,t)=>t?[Object(E.c)(d.a._("Saved to {{sectionName}} in {{boardName}}","Toast for successfully saving to a section within a board"),{sectionName:t.title,boardName:e})]:[d.a._("Saved to"),e]),I(this,"handleLogToastClick",()=>{Object(w.a)(101,{component:20,view:52})}),I(this,"showSuggestedBoardToast",(e,t,n,a)=>{const o=this.props,r=o.hideAllToasts,s=o.shouldShowToast,l=o.showToast;if(s&&!this.state.showSharingUpsell&&e){r();const t=e.name,n=e.url,a=e.image_thumbnail_url;l(({onHide:e})=>i.a.createElement(m.a,{duration:x.a,onHide:e,text:[d.a._("You might also like","Post repin suggested board"),t],href:n,imageUrl:a,onClick:this.handleLogToastClick}))}}),I(this,"showBoardSavedToast",(e,t)=>{(0,this.props.showToast)(({onHide:n})=>i.a.createElement(m.a,{duration:x.a,onHide:n,text:this.getSavedToText(e.name,t),href:t?`${e.url}${t.slug}`:e.url,imageUrl:e.image_cover_url,onClick:this.handleLogToastClick}))}),I(this,"dismissModal",e=>{const t=this.state,n=t.resolve,a=t.newPin;n&&n(a)}),I(this,"fetchBoardRecommendation",e=>{return p.a.create("RelatedBoardForPinRandomFeedResource",{pin:e.id,page_size:1}).callGet({showError:!1}).then(e=>Promise.resolve(e.resource_response.error?null:e.resource_response.data[0]))}),I(this,"handleBoardSaveSuccess",(e,t,n,a)=>{const i=this.props,o=i.action,r=i.dispatch,c=i.pin,h=i.setCompletionPromise,p=i.viewerUserId;s.a.instance.refreshPlacedExperiences();const u=s.a.instance.getPlacedExperience(33),m=s.a.instance.getPlacedExperience(11),b=this.makeCancelablePromise(new Promise((i,s)=>{const l=e.resource_response.data;this.triggerPubSubs(l);const c=this.state.pinDescription.match(j)||[];c.length>0&&Object(w.a)(2,{element:10273,hashtags:JSON.stringify(c),objectId:this.props.pin.id});const h=()=>{this.showBoardSavedToast(t,n),this.safeSetState({displaySuccessAnimation:!0,modalTitle:d.a._("Board created","Modal title after creating a new board"),newPin:l,resolve:i})};"repin"===o?(this.fetchBoardRecommendation(l).then(e=>{this.showSuggestedBoardToast(e,l,n,a)}),u&&500388===u.experience_id?this.safeSetState({showSharingUpsell:!0,newPin:l,resolve:i}):a?h():i(l)):("create"===o&&m&&500840===m.experience_id&&(r(function(e){return{type:"PIN_CREATED_VIA_CREATOR_CHECKLIST",payload:{pin_created_via_creator_checklist:e}}}(!0)),Object(w.a)(7510,{component:13233})),a?h():i(l))}));if(a||r(Object(C.c)(c.id)),h(b),r(Object(k.c)(t)),r(Object(v.d)({boardId:t.id,sectionId:n&&n.id,increment:1})),p&&(r(Object(O.a)({userId:p,increment:1})),r(Object(S.d)())),n||!t.image_cover_url){const e=c.image_url,n=c.images;t.image_cover_url=e||n&&n[B]&&n[B].url||"",r(Object(k.d)({},t))}n&&r(Object(l.a)(n.id)),r(function(e,t){return{type:"PIN_SAVE",payload:{pinId:e,saved:t}}}(c.id,!0))}),I(this,"handleSaveToBoard",(e,t,n)=>{const a=this.props,i=a.onToggleModal,o=a.shouldShowToast;this.setPWTAbort("boardPickerSubmit"),o&&!n&&(this.close(),this.showBoardSavedToast(e,t));const s="secret"===(e.privacy||""),l={board:t?t.id:e.id,state:x.c.LOADING};this.safeSetState({boardSavedTo:l},()=>{this.getPinResource(s,e.id,(t||{}).id).callCreate({showError:!1}).then(a=>{this.safeSetState({boardSavedTo:Object.assign(l,{state:x.c.SUCCESS})},()=>this.handleBoardSaveSuccess(a,e,t,n)),i&&!n&&i(!1)}).catch(e=>{this.unmounted||this.safeSetState({boardSavedTo:null}),r.default.showError(e.message_detail||e.message);const t=this.makeCancelablePromise(Promise.reject(e));this.props.setCompletionPromise(t),i&&i(!1)})})}),I(this,"handleSocialConnectSet",(e,t)=>{const n=Object.assign({},this.state.sharing);e===u.a.FACEBOOK?n.facebook=t:e===u.a.TWITTER&&(n.twitter=t),this.safeSetState({sharing:n})}),I(this,"handleNewBoardAnimationCompletion",()=>{const e=this.props,t=e.dispatch,n=e.pin;t(Object(C.c)(n.id))})}UNSAFE_componentWillReceiveProps(e){const t=this.props,n=t.boardWithSection,a=t.showCreate;this.safeSetState({pinDescription:e.pin&&e.pin.description||e.description||""}),n&&a?this.setModalTitle(d.a._("Create section","modal title for create section pane")):n&&!a&&this.setModalTitle(d.a._("Choose section","modal title for choose section"))}componentWillUnmount(){this.unmounted=!0}setPWTAbort(e){Object(f.a)(e,16)}render(){const e=this.close,t=this.dismissModal,n=this.handleNewBoardAnimationCompletion,a=this.handleSaveToBoard,i=this.handleSocialConnectSet,o=this.setModalTitle,r=this.updateDescription,s=this.state,l=s.boardSavedTo,c=s.displaySuccessAnimation,d=s.modalTitle,h=s.newPin,p=s.showSharingUpsell,u=this.props,m=u.color,b=u.pin;return this.props.children({boardSavedTo:l,color:m,dismissModal:t,displaySuccessAnimation:c,handleAbort:e,handleNewBoardAnimationCompletion:n,handleSaveToBoard:a,handleSocialConnectSet:i,modalTitle:d,newPin:h,pin:b,setModalTitle:o,showSharingUpsell:p,updateDescription:r})}}const R=e=>{const t=e.advertiser,n=e.viewer,a=e.location,i=n.isAuth&&t&&t.owner_user_id!==n.id?t.id:null;return T({location:a},i?{advertiser_id:i}:{},n.isAuth?{viewerUserId:n.id}:{})},D=Object(y.compose)(Object(o.connect)(R),g.a)(P),A=Object(y.compose)(Object(o.connect)(R),g.a,Object(b.b)({name:"FakePinResource",key:"pin",options:({fakeResource:e})=>T({},e.options)}))(P)},RiVL:function(e,t,n){var a=n("GyhR"),i=n.n(a),o=n("Qo1m"),r=n("Y2BC"),s=n("Irlq"),l=n("+U6O");const c=185;var d=Object(r.b)({name:"PinSaveStatusResource",key:"saveStatusResource",options:({pin:e})=>({id:e.id})},{allowStale:!1})(function(e){const t=e.saveStatusResource.data;return t&&t.pinned_to_board?i.a.createElement(l.b,null,i.a.createElement(l.b,{color:"red","data-test-id":"already-pinned",display:"flex",padding:3,shape:"rounded",width:c},i.a.createElement(l.J,{align:"center",bold:!0,color:"white",size:"sm"},Object(s.b)(o.a._("Psst! You already saved this Pin to {{ board_name }} ","Toast for already having repinned pin"),{board_name:(t.pinned_to_board||{}).name}).join(" "))),i.a.createElement(l.b,{display:"flex",justifyContent:"center",marginTop:-3},i.a.createElement(l.m,{accessibilityLabel:"",color:"red",icon:"heart",size:26}))):null}),h=n("P4K9"),p=n("QMJ+"),u=n("hvnN"),m=n.n(u);function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class g extends a.Component{constructor(e,t){super(e,t),b(this,"handleChange",e=>{this.props.onChange&&this.props.onChange.call(this,e.target.value,e.target.selectionStart),this.setState({value:e.target.value})}),b(this,"updateCursor",e=>{this.props.onCursorChange&&this.props.onCursorChange(e.target.selectionStart)}),b(this,"handleKeyUp",e=>{this.props.onKeyUp&&this.props.onKeyUp(e),this.updateCursor(e)}),b(this,"handleKeyDown",e=>{this.props.onKeyDown&&this.props.onKeyDown(e)}),b(this,"handleFocus",e=>{this.props.onFocus&&this.props.onFocus(e),this.updateCursor(e)}),b(this,"handleBlur",e=>{this.props.onBlur&&this.props.onBlur(e)}),b(this,"handleClick",e=>{this.props.onClick&&this.props.onClick(e),this.updateCursor(e)}),this.state={isFocused:this.props.focused||!1,value:this.props.value}}componentDidMount(){this.focusIfNeeded()}UNSAFE_componentWillReceiveProps(e){this.setState({isFocused:e.focused,value:e.value})}componentDidUpdate(){this.focusIfNeeded()}focusIfNeeded(){this.state.isFocused&&document.activeElement!==this._textArea&&this._textArea.focus()}select(){this._textArea.select()}render(){const e=this.props;return i.a.createElement("textarea",{className:e.className,cols:e.cols,disabled:e.disabled?"disabled":"",id:e.id,name:e.name,onBlur:this.handleBlur,onChange:this.handleChange,onClick:this.handleClick,onFocus:this.handleFocus,onKeyDown:this.handleKeyDown,onKeyUp:this.handleKeyUp,placeholder:e.placeholder,ref:e=>{this._textArea=e},rows:e.rows,style:e.style,value:this.state.value})}}g.propTypes={className:m.a.string,cols:m.a.number,disabled:m.a.bool,focused:m.a.bool,id:m.a.string,name:m.a.string,onBlur:m.a.func,onChange:m.a.func,onClick:m.a.func,onCursorChange:m.a.func,onFocus:m.a.func,onKeyDown:m.a.func,onKeyUp:m.a.func,placeholder:m.a.string,rows:m.a.number,style:m.a.object,validators:m.a.arrayOf(m.a.func),value:m.a.string},g.defaultProps={validators:[]};var f=e=>{const t=e.allowChange,n=e.description,i=e.editing,r=e.onHandleDescriptionBlur,s=e.onHandleDescriptionEdit,c=e.onRefTextArea,d=e.onChange,h=e.onCursorChange,p=({description:e,editing:t,allowChange:n})=>a.createElement(l.b,{display:"flex",justifyContent:"between",marginLeft:-1,marginRight:-1},a.createElement(l.b,{paddingX:1,overflow:"hidden"},a.createElement(l.J,{bold:!0,color:e.clamped?"darkGray":"gray",size:"sm"},((e,t)=>e.clamped?e.clamped:t?o.a._("Tell us about this Pin..."):"")(e,n))),a.createElement(l.b,{paddingX:1},!t&&n&&a.createElement(l.m,{accessibilityLabel:o.a._("Edit description"),icon:"edit"})));return a.createElement(l.b,{mdDisplay:"flex"},i?a.createElement(g,{focused:!0,onBlur:r,onFocus:t&&s,onChange:d,onCursorChange:h,placeholder:o.a._("Tell us about this Pin..."),style:t&&{outline:"none",maxHeight:120,minHeight:60,width:"100%"},ref:c,rows:3,value:n.full}):a.createElement(l.b,{width:"100%"},t?a.createElement(l.O,{onTouch:s},a.createElement(p,{description:n,editing:i,allowChange:t})):a.createElement(p,{description:n,editing:i,allowChange:t})))},v=n("MFVv"),y=n("UmN8"),E=n("NmcB");function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"a",function(){return T});const _="PinPanePinMeta",C=236,w=/#[^(. #,\/$%\^&\*;:{}=\`~()\[\]@|<>)]*/,O=/#[^(. #,\/$%\^&\*;:{}=\`~()\[\]@|<>)]*$/,x=0,k="g";class T extends a.Component{constructor(...e){super(...e),S(this,"state",{cursorIndex:-1,flyoutCursorIndex:-1,description:this.props.pin&&this.props.pin.description&&this.props.pin.description.trim()||"",editing:!1,hashtagQuery:"",isHashtagFlyoutOpen:!1,editedBefore:!1,flyoutOpened:!1}),S(this,"onDescriptionChange",(e,t)=>{const n=new RegExp(w,k);let a="";if(t<e.length){let i=n.exec(e),o=n.lastIndex<t;for(;i&&o;)i=n.exec(e),o=n.lastIndex<t;const r=!!i&&w.test(e.slice(i.index,t));o=!!i&&i.index<t,i&&r&&o&&(a=i[x])}else{const t=O.exec(e);a=t?t[x]:""}this.updateDescription(e);const i=w.test(a),o=this.state.isHashtagFlyoutOpen?this.state.flyoutCursorIndex:e.slice(0,t).lastIndexOf("#");this.setState({cursorIndex:t,flyoutCursorIndex:o,description:e,hashtagQuery:a,isHashtagFlyoutOpen:i,flyoutOpened:this.state.flyoutOpened||i})}),S(this,"onCursorChange",e=>{const t=this.state,n=t.isHashtagFlyoutOpen,a=t.flyoutCursorIndex;n&&e<a&&this.setState({isHashtagFlyoutOpen:!1})}),S(this,"updateDescription",e=>{this.props.updateDescription&&this.props.updateDescription(e)}),S(this,"handleDescriptionBlur",e=>{const t=e.target.value.trim(),n=this.state.isHashtagFlyoutOpen;this.updateDescription(t),this.setState({description:t,editing:n})}),S(this,"handleDescriptionEdit",()=>{this.setState({editing:!0,editedBefore:!0})}),S(this,"handleHashtagAddition",e=>{const t=this.props.pin;Object(E.a)(101,{component:208,element:10249,hashtags:e,objectId:t.id});const n=this.state.flyoutCursorIndex,a=Number(n+this.state.hashtagQuery.length),i=this.state.description.slice(0,n)+e+" "+this.state.description.slice(a);this.updateDescription(i),this.setState({description:i,editing:!0,hashtagQuery:"",isHashtagFlyoutOpen:!1})}),S(this,"handleRefTextArea",e=>{this._textArea=e})}render(){const e=this.props,t=e.color,n=e.isFirstPin,a=e.pin,o=e.pinImageRef,r=this.state,s=r.description,c=r.editing,u=r.flyoutOpened,m=r.hashtagQuery,b=r.isHashtagFlyoutOpen,g=a.images,E=a.link,S=g&&g[C+"x"],w=S&&S.url||a.image_base64;return i.a.createElement(l.b,{display:"flex",alignItems:"center",justifyContent:"center",position:"relative",width:n?"50%":"",dangerouslySetInlineStyle:{__style:u&&c?{transform:"translateY(-75px)"}:{}}},i.a.createElement(l.b,{display:"flex",direction:"column",alignItems:"center"},a&&a.id&&i.a.createElement(d,{pin:a}),i.a.createElement(l.b,{paddingY:n?9:0,width:216},i.a.createElement(l.b,{ref:o,maxHeight:u&&c?220:335,shape:"rounded",overflow:"hidden"},w?i.a.createElement(l.o,{alt:s,src:w,naturalHeight:S.height||1,naturalWidth:S.width||1}):!!E&&i.a.createElement(p.a,{color:t||"",description:s,url:E})),i.a.createElement(l.b,{marginTop:2,paddingX:2,id:_},i.a.createElement("div",{ref:e=>{this.anchor=e}},i.a.createElement(y.a,{name:"web_change_titles"},({anyEnabled:e})=>!e&&i.a.createElement(f,{allowChange:!a.is_native,description:Object(v.a)(s),editing:c,hashtagFlyoutOpen:b,onHandleDescriptionBlur:this.handleDescriptionBlur,onHandleDescriptionEdit:this.handleDescriptionEdit,onRefTextArea:this.handleRefTextArea,onChange:this.onDescriptionChange,onCursorChange:this.onCursorChange})))))),this.anchor&&b?i.a.createElement(h.a,{addHashtag:this.handleHashtagAddition,anchor:this.anchor,editing:c,query:m}):null)}}},g4pz:function(e,t,n){n.d(t,"a",function(){return s});var a=n("GyhR"),i=n.n(a);const o="#EFEFEF",r="#333333";function s({size:e,iconColor:t,backgroundColor:n,grayscale:a=!1}){const s=t||(a?r:"#8E8E8E"),l=n||(a?o:"#EFEFEF");return i.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 36 36",version:"1.1"},i.a.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},i.a.createElement("circle",{fill:l,cx:"18",cy:"18",r:"18"}),i.a.createElement("g",{id:"Icons/link",transform:"translate(9.000000, 9.000000)",fill:s,fillRule:"nonzero"},i.a.createElement("path",{d:"M15.75075,5.43075 L12.711,8.46975 L11.916,7.67475 L12.42,7.17075 C12.8595,6.732 12.8595,6.0195 12.42,5.58 C11.9805,5.14125 11.268,5.14125 10.82925,5.58 L10.326,6.084 L9.53025,5.289 L12.56925,2.25 L15.75075,5.43075 Z M8.46975,12.71175 L5.43075,15.75075 L2.24925,12.57 L5.289,9.53025 L6.08325,10.32525 L5.58,10.82925 C5.14125,11.26875 5.14125,11.9805 5.58,12.42 C6.01875,12.8595 6.732,12.85875 7.17075,12.42 L7.674,11.916 L8.46975,12.71175 Z M10.97925,0.65925 L7.9395,3.69825 C7.06125,4.5765 7.06125,6.00075 7.9395,6.87975 L8.73525,7.67475 L7.674,8.73525 L6.879,7.9395 C6.00075,7.06125 4.5765,7.06125 3.69825,7.9395 L0.65925,10.9785 C-0.21975,11.8575 -0.21975,13.28175 0.65925,14.16 L3.84,17.3415 C4.71825,18.21975 6.1425,18.21975 7.02075,17.3415 L10.0605,14.3025 C10.93875,13.4235 10.93875,11.99925 10.0605,11.121 L9.2655,10.32525 L10.326,9.2655 L11.121,10.0605 C11.99925,10.93875 13.4235,10.93875 14.30175,10.0605 L17.34075,7.0215 C18.21975,6.14325 18.21975,4.719 17.34075,3.84 L14.16,0.65925 C13.28175,-0.21975 11.8575,-0.21975 10.97925,0.65925 Z",id:"path-1"}))))}},mpDz:function(e,t,n){function a(e){return{type:"SHOW_REPIN_ANIMATION",payload:{pinId:e}}}function i(){return{type:"HIDE_REPIN_ANIMATION"}}function o(e){return{type:"SET_NUX_ANIMATION_ELEMENT",payload:{nuxAnimationElements:e}}}n.d(t,"c",function(){return a}),n.d(t,"a",function(){return i}),n.d(t,"b",function(){return o})},ms9C:function(e,t,n){var a=n("H++a"),i=n("ePT2"),o=n("UhjI"),r=n("q579"),s=n("LxOv");const l={DIALOG_WIDTH:550,DIALOG_HEIGHT:420,openDialog(e){const t=e.ga_category||"share_twitter";o.a.trackEvent(t,"click");const n=l._getWindowUrl(e.tweet_path,e.tweet_text);s.a.open(n,l.DIALOG_WIDTH,l.DIALOG_HEIGHT)},_getWindowUrl:(e,t)=>r.a.appendQueryString("https://twitter.com/intent/tweet",{via:"pinterest",url:e?r.a.absolutify(e):void 0,text:t||void 0})};var c=l;const d={ObjectTypeToInviteObject:{pin:1,board:2,pinner:3,article:5,did_it:6},_convertToInviteObject(e){return this.ObjectTypeToInviteObject[e]||0},_logShareInvite(e,t){const n=this._convertToInviteObject(e.object_type),a=e.invite_channel,o=null==e.invite_category?3:e.invite_category,r=e.object_id;return i.a.create("SentExternalInviteCallbackResource",{invite_type:{invite_category:o,invite_object:n,invite_channel:a},invite_code:t,object_id:r}).callCreate()},createAndLogShareInvite:e=>d.createShareInviteData(e).then(t=>(d._logShareInvite(e,t.invite_code),Promise.resolve(t)),e=>Promise.reject(e)),createShareInviteData(e){const t=this._convertToInviteObject(e.object_type),n=e.invite_channel,a=null==e.invite_category?3:e.invite_category,o=e.object_id;return i.a.create("CreateExternalInviteResource",{invite_type:{invite_category:a,invite_object:t,invite_channel:n},object_id:o}).callCreate().then(e=>Promise.resolve(e.resource_response.data),e=>Promise.reject(e))},logShareInvite(e,t){t&&d._logShareInvite(e,t.invite_code)},shareFacebookInvite:e=>d.createShareInviteData(e).then(t=>{const n=t.invite_url,i=t.invite_code;return n&&a.default.open({type:"share",object_type:e.object_type,object_id:e.object_id,name:e.name,caption:t.title,description:e.description,path:n,picture:e.picture,callback(t){t&&!t.error_message&&d._logShareInvite(e,i)}}),Promise.resolve(t)},e=>Promise.reject(e)),shareTwitterInvite(e){const t=this._convertToInviteObject(e.object_type);return d.createShareInviteData(e).then(n=>{const a=n.invite_url,i=n.invite_code;let o=e.description;return 6===t&&e.name&&(o=e.name),a&&c.openDialog({tweet_path:a,tweet_text:o}),d._logShareInvite(e,i),Promise.resolve(n)},e=>Promise.reject(e))},shareFbMessengerInvite:e=>d.createShareInviteData(e).then(t=>{const n=t.invite_url,i=t.invite_code;return n&&a.default.open({type:"send",object_type:e.object_type,object_id:e.object_id,name:e.name,caption:t.title,description:e.description,path:n,picture:e.picture,callback(t){t&&t.success&&d._logShareInvite(e,i)}}),Promise.resolve(t)},e=>Promise.reject(e))};t.a=d},rHfS:function(e,t,n){},rWj7:function(e,t,n){},vBjq:function(e,t,n){var a=n("GyhR"),i=n("Ivf5"),o=n("D+W/"),r=n("vI2X"),s=n("Qo1m"),l=n("Reqc"),c=n("KsVg"),d=n("9Y9K"),h=n("+U6O");function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}t.a=Object(d.compose)(Object(i.connect)(),c.a)(class extends a.Component{constructor(e){super(e),p(this,"onCreateSection",()=>{const e=this.props,t=e.board,n=e.dispatch,a=e.completeCreateSectionAction,i=e.pinImport;return this.setState({isSaving:!0}),n(Object(r.a)({boardId:t.id,name:this.state.inputName.trim(),pinImport:i})).then(e=>{this.setState({isSaving:!1,newSection:e}),a(e)}).catch(e=>{this.setState({createError:e.message,isSaving:!1})})}),p(this,"handleKeyDown",({event:e,value:t})=>{const n=this.state,a=n.createError,i=n.inputName;[o.a.KeyCode.ENTER,o.a.KeyCode.NUMPAD_ENTER].includes(e.which)&&!a&&i.trim()&&this.onCreateSection()}),p(this,"handleChangeName",({value:e})=>{this.setState({createError:null,inputName:e})}),p(this,"handleInputRef",e=>{this.setState({inputRef:e})}),this.state={createError:null,inputName:e.initialName||"",inputRef:null,newSection:null,isSaving:!1}}componentDidUpdate(e,t){const n=this.state,a=n.createError,i=n.inputRef;!i||t.inputRef&&!a||i.focus()}render(){const e=this.props,t=e.onClearModal,n=e.showTitle,i=e.positionRelative,o=this.state,r=o.createError,c=o.inputName,d=o.isSaving,p=!!c.trim()&&!r;return a.createElement(h.b,{xs:{display:"flexColumn"},color:"white",flex:"grow",top:!0,bottom:!0,right:!0,position:i?"relative":"absolute",shape:"rounded",width:"100%",dangerouslySetInlineStyle:{__style:{borderLeft:"1px solid #f5f5f5"}}},n&&a.createElement(h.b,{marginTop:3,paddingX:6,paddingY:3},a.createElement(h.J,{size:"xl",bold:!0},s.a._("Add section","Title in the add section modal"))),a.createElement(h.b,{padding:3},a.createElement(h.b,{marginBottom:2},a.createElement(h.p,{htmlFor:"sectionEditName"},a.createElement(h.J,{size:"sm",color:r?"red":"gray"},s.a._("Name","Board section name")))),a.createElement(h.b,null,a.createElement(h.b,{ref:this.handleInputRef},a.createElement(h.L,{id:"sectionEditName",name:"sectionName",onChange:this.handleChangeName,onKeyDown:this.handleKeyDown,errorMessage:r||"",placeholder:s.a._('Like "Lighting"',"Placeholder for board section name"),type:"text",value:c})))),a.createElement(h.i,null),a.createElement(h.b,{display:"flex",flex:"grow"}),a.createElement(h.i,null),a.createElement(h.b,{padding:6},a.createElement(h.b,{display:"flex",justifyContent:"between"},a.createElement(h.c,{onClick:t,text:s.a._("Cancel","cancel section add"),inline:!0}),a.createElement(l.b,{disabled:!p||d,onClick:this.onCreateSection,submitting:d,text:s.a._("Add","add a new section")}))))}})}}]);
//# sourceMappingURL=pjs-5-0ff83e87eafc7e5a5957.mjs.map
